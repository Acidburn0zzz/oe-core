patch taken from sabotage linux -- https://github.com/rofl0r/sabotage

Upstream-Status: Unknown
Signed-off-by: Khem Raj <raj.khem@gmail.com>


Index: util-linux-2.24.1/include/ttyutils.h
===================================================================
--- util-linux-2.24.1.orig/include/ttyutils.h	2013-10-10 03:44:17.000000000 -0700
+++ util-linux-2.24.1/include/ttyutils.h	2014-04-02 00:58:02.918775059 -0700
@@ -10,6 +10,7 @@
 #include <stdlib.h>
 #include <termios.h>
 #include <limits.h>
+#include <sys/ttydefaults.h>
 #ifdef HAVE_SYS_IOCTL_H
 #include <sys/ioctl.h>
 #endif
Index: util-linux-2.24.1/text-utils/hexdump.h
===================================================================
--- util-linux-2.24.1.orig/text-utils/hexdump.h	2014-01-20 04:25:31.000000000 -0800
+++ util-linux-2.24.1/text-utils/hexdump.h	2014-04-02 00:58:02.918775059 -0700
@@ -32,7 +32,7 @@
  *
  *	@(#)hexdump.h	5.4 (Berkeley) 6/1/90
  */
-
+#include <sys/types.h>
 typedef struct _pr {
 	struct _pr *nextpr;		/* next print unit */
 #define	F_ADDRESS	0x001		/* print offset */
Index: util-linux-2.24.1/text-utils/pg.c
===================================================================
--- util-linux-2.24.1.orig/text-utils/pg.c	2013-10-18 04:52:50.000000000 -0700
+++ util-linux-2.24.1/text-utils/pg.c	2014-04-02 00:58:02.918775059 -0700
@@ -37,7 +37,7 @@
 #ifndef	TIOCGWINSZ
 # include <sys/ioctl.h>
 #endif
-#include <sys/termios.h>
+#include <termios.h>
 #include <fcntl.h>
 #include <regex.h>
 #include <stdio.h>
Index: util-linux-2.24.1/libfdisk/src/sun.c
===================================================================
--- util-linux-2.24.1.orig/libfdisk/src/sun.c	2014-01-20 04:25:31.183846196 -0800
+++ util-linux-2.24.1/libfdisk/src/sun.c	2014-04-02 01:02:07.352109748 -0700
@@ -361,9 +361,11 @@
 	}
 }
 
-static int verify_sun_cmp(int *a, int *b, void *data)
+static void* cmp_data;
+static int verify_sun_cmp(const void *pa, const void *pb)
 {
-    unsigned int *verify_sun_starts = (unsigned int *) data;
+    const int *a = pa, *b = pb;
+    unsigned int *verify_sun_starts = (unsigned int *) cmp_data;
 
     if (*a == -1)
 	    return 1;
@@ -427,9 +429,8 @@
         else
             array[i] = -1;
     }
-    qsort_r(array,ARRAY_SIZE(array),sizeof(array[0]),
-	  (int (*)(const void *,const void *,void *)) verify_sun_cmp,
-	  verify_sun_starts);
+    cmp_data = verify_sun_starts;
+    qsort(array,ARRAY_SIZE(array),sizeof(array[0]), verify_sun_cmp);
 
     if (array[0] == -1) {
 	fdisk_info(cxt, _("No partitions defined."));
